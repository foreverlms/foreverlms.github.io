<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<title>用C实现一棵二叉树</title>
	<meta name="description" content="用C实现一棵二叉树C Primer Plus–高级数据结构表示之二叉树">
	<meta name="keywords" content="c, C Primer Plus, 寒鸥惊起一双双" />
	<link rel="canonical" href="https://blog.bobliao.xyz/%E7%AC%94%E8%AE%B0/2018/03/22/c-binary-tree.html">
	<link rel="alternate" type="application/rss+xml" title="寒鸥惊起一双双" href="https://blog.bobliao.xyz/feed.xml" />
   	<link rel="stylesheet" type="text/css" href="/css/index.css">
</head>

<body>
<div class="body-wrapper">
<div class="nav-header">
<a href="/">寒鸥惊起一双双</a> | <a href="https://github.com/foreverlms" target="_blank">Github</a> |<a href="/about"> 关于我 </a></div>
<div class="main-body">
<header>
<h2>用C实现一棵二叉树</h2>
<p><i>2018-03-22</i></p>
</header>
<article>
<p>用C实现一棵二叉树
<!--more-->
C Primer Plus–高级数据结构表示之二叉树</p>

<h2 id="二叉搜索树-binary-search-tree">二叉搜索树 Binary Search Tree</h2>

<p>二叉树是一种高级数据结构。树中的每个节点都包含一个项目和两个指向其他节点的指针。
每个节点都有两个子节点：左节点、右节点。在左节点中的项目是父节点中项目的前序向，而在右节点中的项目是父节点项目的后序向。
二叉树中每一个节点本身是其后代节点的根，此节点与其后代节点构成一个子树，子树有左右之分。</p>
<h2 id="用c构建二叉树adt">用C构建二叉树ADT</h2>
<p>首先明确二叉树结构：</p>
<blockquote>
  <p>二叉树或者是一个空的节点集合（空树），或者是一个指定某个节点为根的节点集合。每个节点有两个作为其后代的树，称为左子树和右子树。
每个子树本身又是一个二叉树，也包含它是个空树的可能性。
二叉搜索树是有序的二叉树，它的每个节点包含一个项目，它的所有左子树的项目排在根项目的前面，而根项目排在所有右子树项目的前面。</p>
</blockquote>

<p>而且二叉树的类型操作有：</p>
<ul>
  <li>树初始化为空树</li>
  <li>查询树是否为空</li>
  <li>查询树是否已满</li>
  <li>查询树中项目个数</li>
  <li>向树中添加项目</li>
  <li>从树中删除项目</li>
  <li>从树中搜索一个项目</li>
  <li>遍历树中所有项目</li>
  <li>清空树</li>
</ul>

<h3 id="树结构的定义">树结构的定义</h3>
<p>假设一个项目中包含一部电影的名字，上映年份，我们定义项目为<code class="highlighter-rouge">Item</code>：定义节点<code class="highlighter-rouge">Node</code>结构，包含一部电影，节点的左子节点，节点的右子节点指针；定义结构<code class="highlighter-rouge">Tree</code>包含根节点指针、树的项目个数。</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define TITLE_MAX_CHARS 40
</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">movie</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">title</span><span class="p">[</span><span class="n">TITLE_MAX_CHARS</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">year</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Item</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">node</span> <span class="p">{</span>
    <span class="n">Item</span> <span class="n">movie</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">movie</span> <span class="o">*</span> <span class="n">left</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">movie</span> <span class="o">*</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Node</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">tree</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">root</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Tree</span><span class="p">;</span>
</code></pre></div></div>
<p>定义好了数据结构，下面进行树操作的定义：</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//初始化树</span>
<span class="kt">void</span> <span class="nf">InitializeTree</span><span class="p">(</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//树是空的吗？</span>
<span class="n">bool</span> <span class="nf">TreeIsEmpty</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//树满了吗？假定我们队树的最大项目树有要求</span>
<span class="n">bool</span> <span class="nf">TreeIsFull</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//查询树的项目数</span>
<span class="n">bool</span> <span class="nf">TreeSize</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//向树添加项目</span>
<span class="n">bool</span> <span class="nf">AddMovieToTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//从树删除项目</span>
<span class="n">bool</span> <span class="nf">DleteMovieFromTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//项目是否重复？</span>
<span class="n">bool</span> <span class="nf">IsInTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="c1">//遍历树的项目</span>
<span class="kt">void</span> <span class="nf">TraverseTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">,</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">ptoFunc</span><span class="p">)</span> <span class="p">(</span><span class="n">Item</span> <span class="n">item</span><span class="p">));</span>
</code></pre></div></div>

<p>完整程序如下：
<code class="highlighter-rouge">binarySearchTree.h</code>：</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//</span>
<span class="c1">// Created by bob on 2018/11/14.</span>
<span class="c1">//</span>

<span class="cp">#ifndef LEARNINGC_BINARYSEARCHTREE_H
#define LEARNINGC_BINARYSEARCHTREE_H
</span>
<span class="cp">#include &lt;stdbool.h&gt;
</span>
<span class="cp">#define MAX_ITEMS 40
#define TITLE_MAX_CHARS 40
</span><span class="k">typedef</span> <span class="k">struct</span> <span class="n">movie</span> <span class="p">{</span>
    <span class="kt">char</span> <span class="n">title</span><span class="p">[</span><span class="n">TITLE_MAX_CHARS</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">year</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Item</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">node</span> <span class="p">{</span>
    <span class="n">Item</span>  <span class="n">movie</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">node</span> <span class="o">*</span> <span class="n">left</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">node</span> <span class="o">*</span> <span class="n">right</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Node</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">tree</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">root</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Tree</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">pair</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">parent</span><span class="p">;</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">child</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Pair</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">InitializeTree</span><span class="p">(</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="n">bool</span> <span class="nf">TreeIsEmpty</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="n">bool</span> <span class="nf">TreeIsFull</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="kt">int</span> <span class="nf">TreeSize</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="n">bool</span> <span class="nf">AddMovieToTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="n">bool</span> <span class="nf">DleteMovieFromTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="n">bool</span> <span class="nf">IsInTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">TraverseTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">,</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">ptoFunc</span><span class="p">)</span> <span class="p">(</span><span class="n">Item</span> <span class="n">item</span><span class="p">));</span>

<span class="kt">void</span> <span class="nf">ClearTree</span><span class="p">(</span><span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">);</span>

<span class="cp">#endif //LEARNINGC_BINARYSEARCHTREE_H
</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">binarySearchTree.c</code>：</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//</span>
<span class="c1">// Created by bob on 2018/11/14.</span>
<span class="c1">//</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include "binarySearchTree.h"
</span>
<span class="k">static</span> <span class="n">Pair</span> <span class="nf">SeekItem</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="p">);</span>
<span class="k">static</span> <span class="n">bool</span> <span class="nf">ToLeft</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">p2</span><span class="p">);</span>
<span class="k">static</span> <span class="n">bool</span> <span class="nf">ToRight</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">p2</span><span class="p">);</span>
<span class="k">static</span> <span class="n">Node</span> <span class="o">*</span> <span class="nf">MakeNode</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">);</span>
<span class="k">static</span> <span class="n">bool</span> <span class="nf">AddNodeToTree</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span> <span class="n">new_node</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span> <span class="n">root</span><span class="p">);</span>
<span class="k">static</span> <span class="n">bool</span> <span class="nf">DeleteNode</span><span class="p">(</span><span class="n">Node</span> <span class="o">**</span> <span class="n">p</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">Traverse</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">,</span><span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pfunc</span><span class="p">)</span> <span class="p">(</span><span class="n">Item</span> <span class="n">movie</span><span class="p">));</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">InOrder</span><span class="p">(</span><span class="k">const</span> <span class="n">Node</span> <span class="o">*</span> <span class="n">parent</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pfunc</span><span class="p">)</span> <span class="p">(</span><span class="n">Item</span> <span class="n">movie</span><span class="p">));</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">DeleteAllNodes</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span> <span class="n">parent</span><span class="p">);</span>
<span class="n">Pair</span> <span class="nf">SeekItem</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span> <span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">Pair</span> <span class="n">scan</span><span class="p">;</span>
    <span class="n">scan</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">scan</span><span class="p">;</span>

    <span class="k">while</span> <span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ToLeft</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">,</span><span class="o">&amp;</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">))){</span>
            <span class="n">scan</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
            <span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ToRight</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">,</span><span class="o">&amp;</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">))){</span>
            <span class="n">scan</span><span class="p">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="p">;</span>
            <span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">=</span> <span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span><span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">scan</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">ToLeft</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">p2</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">compl</span><span class="p">;</span>

    <span class="k">if</span><span class="p">((</span><span class="n">compl</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">p1</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">,</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">compl</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">p1</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">,</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">year</span> <span class="o">&lt;</span> <span class="n">p2</span><span class="o">-&gt;</span><span class="n">year</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">ToRight</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">p1</span><span class="p">,</span> <span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">p2</span><span class="p">)</span> <span class="p">{</span>
     <span class="kt">int</span> <span class="n">compl</span><span class="p">;</span>

     <span class="k">if</span><span class="p">((</span><span class="n">compl</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">p1</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">,</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
         <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
     <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">compl</span> <span class="o">=</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">p1</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">,</span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">p1</span><span class="o">-&gt;</span><span class="n">year</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="o">-&gt;</span><span class="n">year</span><span class="p">)</span>
         <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
     <span class="k">else</span>
         <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">Node</span> <span class="o">*</span> <span class="nf">MakeNode</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">ptoItem</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">new_node</span><span class="p">;</span>
    <span class="n">new_node</span> <span class="o">=</span> <span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Node</span><span class="p">));</span>

    <span class="k">if</span><span class="p">(</span><span class="n">new_node</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"Can not allocate memory to create a node.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptoItem</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">new_node</span><span class="o">-&gt;</span><span class="n">movie</span> <span class="o">=</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">;</span>
        <span class="n">new_node</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
        <span class="n">new_node</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">new_node</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">AddNodeToTree</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="n">new_node</span><span class="p">,</span> <span class="n">Node</span> <span class="o">*</span> <span class="n">root</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ToLeft</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new_node</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">,</span><span class="o">&amp;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
            <span class="n">root</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">=</span> <span class="n">new_node</span><span class="p">;</span>
        <span class="k">else</span>
            <span class="n">AddNodeToTree</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">ToRight</span><span class="p">(</span><span class="o">&amp;</span><span class="n">new_node</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">,</span><span class="o">&amp;</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">)){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
            <span class="n">root</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="n">new_node</span><span class="p">;</span>
        <span class="k">else</span>
            <span class="n">AddNodeToTree</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span><span class="n">root</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"Error in locating the inserting index of this node.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">DeleteNode</span><span class="p">(</span><span class="n">Node</span> <span class="o">**</span> <span class="n">p</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">p_temp</span><span class="p">;</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Deleting the movie:"</span><span class="p">);</span>
    <span class="n">puts</span><span class="p">((</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">.</span><span class="n">title</span><span class="p">);</span>
    <span class="k">if</span><span class="p">((</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">p_temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
        <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
        <span class="n">free</span><span class="p">(</span><span class="n">p_temp</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">p_temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
        <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
        <span class="n">free</span><span class="p">(</span><span class="n">p_temp</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">p_temp</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span><span class="n">p_temp</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span><span class="n">p_temp</span> <span class="o">=</span> <span class="n">p_temp</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">)</span>
            <span class="k">continue</span><span class="p">;</span>
        <span class="n">p_temp</span><span class="o">-&gt;</span><span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
        <span class="n">p_temp</span> <span class="o">=</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
        <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">;</span>
        <span class="n">free</span><span class="p">(</span><span class="n">p_temp</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">Traverse</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pfunc</span><span class="p">)(</span><span class="n">Item</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptoTree</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="n">InOrder</span><span class="p">(</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">,</span><span class="n">pfunc</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">InOrder</span><span class="p">(</span><span class="k">const</span> <span class="n">Node</span> <span class="o">*</span><span class="n">parent</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pfunc</span><span class="p">)(</span><span class="n">Item</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">parent</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">InOrder</span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">,</span><span class="n">pfunc</span><span class="p">);</span>
        <span class="p">(</span><span class="o">*</span><span class="n">pfunc</span><span class="p">)(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">movie</span><span class="p">);</span>
        <span class="n">InOrder</span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">,</span><span class="n">pfunc</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">DeleteAllNodes</span><span class="p">(</span><span class="n">Node</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Node</span> <span class="o">*</span> <span class="n">ptoRight</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">parent</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">ptoRight</span> <span class="o">=</span> <span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">;</span>
        <span class="n">DeleteAllNodes</span><span class="p">(</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
        <span class="n">free</span><span class="p">(</span><span class="n">parent</span><span class="p">);</span>
        <span class="n">DeleteAllNodes</span><span class="p">(</span><span class="n">ptoRight</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="nf">InitializeTree</span><span class="p">(</span><span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ptoTree</span> <span class="o">-&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">TreeIsEmpty</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">TreeIsFull</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">&gt;=</span> <span class="n">MAX_ITEMS</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">TreeSize</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">AddMovieToTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span> <span class="n">ptoItem</span><span class="p">,</span> <span class="n">Tree</span> <span class="o">*</span> <span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ptoItem</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="o">|</span> <span class="n">strlen</span><span class="p">(</span><span class="n">ptoItem</span><span class="o">-&gt;</span><span class="n">title</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">|</span> <span class="n">ptoItem</span><span class="o">-&gt;</span><span class="n">year</span> <span class="o">&lt;</span> <span class="mi">1800</span><span class="p">){</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"The movie you are adding has something wrong."</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">TreeIsFull</span><span class="p">(</span><span class="n">ptoTree</span><span class="p">)){</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"The tree is full. You can not add a movie to a full tree"</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">SeekItem</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">,</span><span class="n">ptoTree</span><span class="p">).</span><span class="n">child</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">){</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="s">"Trying to add duplicate movie.</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Node</span> <span class="o">*</span> <span class="n">new_node</span><span class="p">;</span>

    <span class="n">new_node</span> <span class="o">=</span> <span class="n">MakeNode</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">);</span>
<span class="c1">//    if(new_node == NULL){</span>
<span class="c1">//</span>
<span class="c1">//    }//无需判断new_node是否为空指针，MakeNode函数里已经做过了</span>

    <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span><span class="o">++</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span> <span class="o">=</span> <span class="n">new_node</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">AddNodeToTree</span><span class="p">(</span><span class="n">new_node</span><span class="p">,</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">);</span>

    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>

<span class="p">}</span>

<span class="n">bool</span> <span class="nf">DleteMovieFromTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">ptoItem</span><span class="p">,</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Pair</span> <span class="n">scan</span><span class="p">;</span>
    <span class="n">scan</span> <span class="o">=</span> <span class="n">SeekItem</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">,</span><span class="n">ptoTree</span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">child</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">parent</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="n">DeleteNode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">scan</span><span class="p">.</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span> <span class="o">==</span> <span class="n">scan</span><span class="p">.</span><span class="n">child</span><span class="p">)</span>
        <span class="c1">//这里不能传scan.child，虽染这两个指向的是同一个node，但我们必须得传父节点持有的指针的指针</span>
        <span class="n">DeleteNode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">scan</span><span class="p">.</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">left</span><span class="p">);</span>
    <span class="k">else</span>
        <span class="n">DeleteNode</span><span class="p">(</span><span class="o">&amp;</span><span class="n">scan</span><span class="p">.</span><span class="n">parent</span><span class="o">-&gt;</span><span class="n">right</span><span class="p">);</span>

    <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span><span class="o">--</span><span class="p">;</span>

    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">bool</span> <span class="nf">IsInTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Item</span> <span class="o">*</span><span class="n">ptoItem</span><span class="p">,</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">SeekItem</span><span class="p">(</span><span class="n">ptoItem</span><span class="p">,</span><span class="n">ptoTree</span><span class="p">).</span><span class="n">child</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">TraverseTree</span><span class="p">(</span><span class="k">const</span> <span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">,</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">ptoFunc</span><span class="p">)(</span><span class="n">Item</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">Traverse</span><span class="p">(</span><span class="n">ptoTree</span><span class="p">,</span><span class="n">ptoFunc</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">ClearTree</span><span class="p">(</span><span class="n">Tree</span> <span class="o">*</span><span class="n">ptoTree</span><span class="p">)</span> <span class="p">{</span>

    <span class="k">if</span><span class="p">(</span><span class="n">ptoTree</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">DeleteAllNodes</span><span class="p">(</span><span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span><span class="p">);</span>

    <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">root</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
    <span class="n">ptoTree</span><span class="o">-&gt;</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


</code></pre></div></div>

<p>好乱，日后再改。</p>

</article>
<div id="info-bottom">
<hr>
<p>标签: <block class="tag"><a href="/archive/#c">c</a></block><block class="tag"><a href="/archive/#C Primer Plus">C Primer Plus</a></block></p>
<p><b>留言</b>请用 <a href="https://github.com/foreverlms/foreverlms.github.io/issues"> Github Issues </a></p>
<p><b>聊天</b>请在 <a href="https://gitter.im/foreverlms/community" target="_blank">gitter.im/foreverlms</a> </p>
</div>

</div>
<div class="info-bottom"><div class="info-bottom-text">
License <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a> | Subscribe <a href="/feed.xml">RSS</a> | Email <a href="mailto:codechaser@163.com">codechaser囧163.com</a> | 博客模板 <a href="https://fzheng.me/" target="_blank">无求备斋笔记</a>
</div></div> 
</div>
</body>
<script src="https://use.typekit.net/hvv6ahj.js"></script>
<script>try{Typekit.load({ async: true });}catch(e){}</script>
</html>